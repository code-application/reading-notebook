# 第5章：要件とユーザーストーリー
### 本章の概要
* スクラムプロジェクトにおける要件の扱いが、伝統的なプロジェクトとどのように違うのか説明する。
* ビジネス価値を表現する共通形式として、ユーザーストーリーを説明する
* ユーザーストーリーとはどのようなものか、複数の中小レベルでビジネス価値をどのように表現するのか、どのような場面で役立つのかを説明する
* さらに、非機能要件の扱い方、知識獲得方法について説明する
* 最後にユーザーストーリーを収集するテクニックを紹介する

### スクラムにおける要件の扱い
* 自由変数である
    * 時間か予算があふれてしまった場合、優先順位の低い要件を断念できる
* 不必要な詳細化はしない
    * 理解が深まるほど仕様が変わるという前提を置いている
    * 後になって捨てるくらいなら大きな投資はしない
    * 最初のPBIは詳細はほとんど記載されないが、開発が進む中で関係者が会話と通じて詳細なPBIに分解する

> [!NOTE]
> 
> :memo:コメント
> 
> > 時間か予算があふれてしまった場合、優先順位の低い要件を断念できる
> 
> * 順次的なプロセスの場合、最初に要件を決めて、そこからテスト計画をして漏れのないテストケースを作成していくが、スクラムで当初計画していた（いなかった）けど、あとで削除（追加）になったフィーチャーがある場合、テストにおいて漏れのないケースを作成する難易度が上がりそう。
>   * 当初あった画面があり、その周辺の画面遷移とデータ連携があった場合、中間の画面がなくなることで画面遷移やデータ連携について最初から考え直さなければならず、規模によっては認知負荷が高くなり、見落としが増える可能性が上がる。（RyoyaC）

## 対話する
* 要件はプロダクトの理解に欠かせない事柄への共通理解を促進するコミュニケーション手段
    * 開発者が要件に詳しい人と常に会話できるようにした方がいい
    * スクラムでは要件を議論するツールとして「会話」を利用する
    * しかし、会話もただのツールでしかないので、ドキュメントを完全に置き換えることはできない
        * プロダクトバックログは「生きているドキュメント」
        * 必要ならプロダクトバックログアイテムとその詳細をまとめて形式を整理すればよい

## 改良し続ける
* すべての要件が常に同じ詳細レベルを求められるのは都合が悪い
    * プロジェクト初期時点で詳しくないことについて、詳細を予測しなければならない
    * 優先度が等しくなり、将来的に不要な要件も詳細化の時間が必要になる
* スクラムでは**段階的洗練戦略**をとり、要件を詳細化していく
    * 必要になったときにジャストインタイムで詳細化されていない大きな要件を小さな詳細化された要件の集まりにする

## ユーザーストーリーとは何なのか
* ユーザーストーリーとは、様々な種類のフィーチャーに期待されるビジネス価値を表現する便利な形式
    * ユーザーストーリーはプロダクトバックログアイテムを表現する唯一の方法ではない

### ユーザーストーリーを表す3つのC
* カード(card)
    * 以下の要素を具体的に記述する
        * ユーザーの分類（役割）
        * ユーザーの求めているもの（目的）
        * 求める理由（利益）
    * カードは要件の意図や本質をとらえた数行の文章であるべき
        * ステークホルダー、プロダクトオーナー、開発者をより詳細な議論へ導く
    * テンプレート
        * タイトル：ユーザーストーリーのタイトル
        * 内容：＜役割＞として、私は＜目的＞したい。なぜなら＜利益＞だからだ。
    * 記載例
        * タイトル：関係者のレビューを受けること
        * 内容：一般的な利用者として、近所のレストランについての偏見のないレビューを聞きたい。どこで夕食をとるか決められるからだ。
* 対話(conversation)
    * 要件の詳細は、関係者の間の対話によって具体化され共有される
        * 対話は一度きりのイベントではなく、継続するやり取り
    * ユーザーストーリーの利点
        * 書くことに向けていた注意を対話に向ける
            * 正確な要件がだれにとっても理解できるように表現されることを後押しする
* 確認(confirmation)
    * ユーザーストーリーには満足条件という確認のための情報が含まれる
        * 期待される振る舞いを明示する
        * カードの裏面に満足条件を書く
        * 満足条件は概要レベルの受け入れテストとして表現される

## 詳細化のレベル
※エピックやテーマといった用語それ自体が重要なのではなく、ユーザーストーリーは複数の抽象化レベルをまたいで表現でき、大きい項目を小さく分割するという段階的改良ができる
* エピック
    * 期間が数か月やそれ以上で、最も抽象ていなユーザーストーリー
    * 期待されることの概要や全体像がわかる
* フィーチャー
    * エピックの次に抽象度が低く、数週間程度の期間で1スプリントには入りきらない程度のユーザーストーリー
* ストーリー
    * スプリント可能なストーリー、実装可能なストーリーなどと呼ぶこともある
* テーマ
    * ユーザーストーリーをまとめたもの
    * 共通点をもつユーザーストーリーをひとくくりにしたもの
* タスク
    * ユーザーストーリーの下位の抽象度で、whatではなくhowを決める
    * **タスクはユーザーストーリーではない**ため、ユーザーストーリーを書くときはタスクレベルの詳細は書かない

## INVEST原則
* 独立している(Independent)
    * 関連があるとしても疎結合であるべき
    * すべての依存性をなくすのではなく、依存性を最小化するようにストーリーを書く
* 交渉できる(Negotiable)
    * ユーザーストーリーは内容と理由を説明すうべきで、方法を説明するべきではない
        * どうやるのかが交渉できなくなれば、チームがそう増益になる機会がなくなる
* 価値がある(Valuable)
* 見積もり可能(Estimatable)
* 小さい(Small)
* テスト可能(Testable)

## 非機能要件
* 非機能要件の扱い方
    * 筆者はユーザーストーリーで書くことが多いが、そうしなければいけないわけではない
    * 別の形式を採用しても問題ない
* 非機能要件は可能な限り多く完成の定義に含める方がいい
    * 非機能要件のテストを開発終盤まで遅らせるとシステム性能に致命的な影響を与えかねない特性について早期にフィードバックを得ることができる

## 学習のためのストーリー
* 知識を得るためのストーリー
* 技術的なストーリーのビジネス価値はプロダクトオーナーによって妥当であると認められなければならない

## ストーリーの収集
* 利用者に「何が欲しいのか」を聞いてもまともな答えは得られない
    * 利用者をチームの一員として巻き込むと良い
    * 何を作るか一緒に決めて、定期的にレビューする

### ユーザーストーリ―記述ワークショップ
* 目的
    * ビジネス価値について協力的にブレインストーミングを行うこと
    * 想定するプロダクトのためのユーザーストーリーの類型を作ること
* 参加者
    * プロダクトオーナー
    * スクラムマスター
    * 開発チーム
    * ステークホルダー
* 期間
    * 数時間から数日
    * 完全なユーザーストーリーを作ることが目的ではないため、長引かせるべきではない
* やること
    * ユーザーロール分析
        * ユーザーの役割を集めること
        * 役割ごとにペルソナを差空制する
    * ストーリーの作成
        * トップダウン、ボトムアップどちらでも可
        * ペルソナ、ユーザーロールに当てはめながらストーリーを作っていく

### ストーリーマッピング
* 概要
    * 抽象的なユーザーの行為を詳細タスクによって組み立てられるワークフローに分解する
    * ユーザーストーリー記述ワークショップを補完する
* 言葉の説明
    * アクティビティ
        * エピックと同様
    * タスク
        * テーマと同様
    * サブタスク
        * スプリント可能なストーリーと同様
* 実施方法
    * 最も抽象的なエピックを決める
    * エピックを達成するために必要な手段、あるいは利用者のタスクである一般的なワークフローを考える
    * 時間軸に沿ってテーマを並べる
    * それぞれのテーマを実装可能なストーリーに分解し、優先順位に基づいて縦に並べる
        * ここでの優先順位は利用者にとっての価値だけを表す
* 注意
    * テーマに紐づくすべてのストーリ―を同じリリースに含める必要はない


> [!NOTE]
> 
> :memo:コメント
> 
>　> 技術的なストーリーのビジネス価値はプロダクトオーナーによって妥当であると認められなければならない
>
> 技術的負債を経済学における「公共財」としてとらえて、各スプリントから「税金」としてスプリントの一部に技術的負債返済のための工数を使うようにする、というメタファーがよさそう。もう少し詳細に整理したい。（RyoyaC）